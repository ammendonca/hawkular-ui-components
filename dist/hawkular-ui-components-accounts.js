/// Copyright 2014-2015 Red Hat, Inc. and/or its affiliates
/// and other contributors as indicated by the @author tags.
///
/// Licensed under the Apache License, Version 2.0 (the "License");
/// you may not use this file except in compliance with the License.
/// You may obtain a copy of the License at
///
///   http://www.apache.org/licenses/LICENSE-2.0
///
/// Unless required by applicable law or agreed to in writing, software
/// distributed under the License is distributed on an "AS IS" BASIS,
/// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
/// See the License for the specific language governing permissions and
/// limitations under the License.


var HawkularAccounts;
(function (HawkularAccounts) {
    HawkularAccounts.pluginName = "hawkular-accounts";
    HawkularAccounts.log = Logger.get(HawkularAccounts.pluginName);
    HawkularAccounts.templatePath = "plugins/accounts/html";
})(HawkularAccounts || (HawkularAccounts = {}));

var HawkularAccounts;
(function (HawkularAccounts) {
    HawkularAccounts._module = angular.module(HawkularAccounts.pluginName, []);
    var accountsTab = undefined;
    HawkularAccounts._module.config(['$locationProvider', '$routeProvider', 'HawtioNavBuilderProvider', function ($locationProvider, $routeProvider, builder) {
        accountsTab = builder.create().id(HawkularAccounts.pluginName).title(function () { return "Accounts"; }).href(function () { return "/accounts"; }).subPath("My account", "accounts", builder.join(HawkularAccounts.templatePath, 'accounts.html')).subPath("Organizations", "organizations", builder.join(HawkularAccounts.templatePath, 'organizations.html')).build();
        builder.configureRouting($routeProvider, accountsTab);
        $routeProvider.when('/accounts/organizations/new', { templateUrl: builder.join(HawkularAccounts.templatePath, 'organization_new.html') });
        $locationProvider.html5Mode(true);
    }]);
    HawkularAccounts._module.run(['HawtioNav', function (HawtioNav) {
    }]);
    hawtioPluginLoader.addModule(HawkularAccounts.pluginName);
})(HawkularAccounts || (HawkularAccounts = {}));

var HawkularAccounts;
(function (HawkularAccounts) {
    var AuthService = (function () {
        function AuthService($rootScope, $window) {
            var _this = this;
            this.$rootScope = $rootScope;
            this.$window = $window;
            this.onReady(function () {
                _this.$rootScope['username'] = _this.keycloak().idTokenParsed.name;
            });
        }
        AuthService.prototype.keycloak = function () {
            return this.$window['keycloak'];
        };
        AuthService.prototype.onReady = function (callback) {
            var _this = this;
            if (this.$window['keycloakReady'] === true) {
                callback();
            }
            else {
                this.keycloak().onReady = function () {
                    _this.$window['keycloakReady'] = true;
                    callback();
                };
            }
        };
        AuthService.prototype.logout = function () {
            return this.keycloak().logout();
        };
        AuthService.prototype.updateToken = function (periodicity) {
            return this.keycloak().updateToken(periodicity);
        };
        AuthService.prototype.token = function () {
            return this.keycloak().token;
        };
        AuthService.prototype.isAuthenticated = function () {
            return this.keycloak() && this.keycloak().authenticated;
        };
        AuthService.$inject = ['$rootScope', '$window'];
        return AuthService;
    })();
    HawkularAccounts.AuthService = AuthService;
    HawkularAccounts._module.service('Auth', AuthService);
})(HawkularAccounts || (HawkularAccounts = {}));

var HawkularAccounts;
(function (HawkularAccounts) {
    var AuthInterceptorService = (function () {
        function AuthInterceptorService($q, Auth) {
            var _this = this;
            this.$q = $q;
            this.Auth = Auth;
            this.request = function (request) {
                console.debug('Intercepting request');
                var BASE_URL = "http://localhost:8080/hawkular-";
                var addBearer, deferred;
                if (request.url.indexOf(BASE_URL) === -1) {
                    console.debug('The requested URL is not part of the base URL. Base URL: ' + BASE_URL + ', requested URL: ' + request.url);
                    return request;
                }
                addBearer = function () {
                    return _this.Auth.updateToken(5).success(function () {
                        var token = _this.Auth.token();
                        console.debug('Adding bearer token to the request: ' + token);
                        request.headers.Authorization = 'Bearer ' + token;
                        deferred.notify();
                        return deferred.resolve(request);
                    }).error(function () {
                        console.log("Couldn't update token");
                    });
                };
                deferred = _this.$q.defer();
                _this.Auth.onReady(addBearer);
                return _this.$q.when(deferred.promise);
            };
            this.responseError = function (rejection) {
                console.debug('Intercepting error response');
                if (rejection.status === 401) {
                    _this.Auth.logout();
                }
                return _this.$q.reject(rejection);
            };
        }
        AuthInterceptorService.Factory = function ($q, Auth) {
            return new AuthInterceptorService($q, Auth);
        };
        AuthInterceptorService.$inject = ['$q', 'Auth'];
        return AuthInterceptorService;
    })();
    HawkularAccounts.AuthInterceptorService = AuthInterceptorService;
    HawkularAccounts._module.config(function ($httpProvider) {
        console.debug('Adding AuthInterceptor');
        return $httpProvider.interceptors.push(HawkularAccounts.AuthInterceptorService.Factory);
    });
})(HawkularAccounts || (HawkularAccounts = {}));

var HawkularAccounts;
(function (HawkularAccounts) {
    HawkularAccounts.OrganizationsController = HawkularAccounts._module.controller("HawkularAccounts.OrganizationsController", [
        '$scope',
        'HawkularAccounts.OrganizationService',
        '$log',
        '$location',
        function ($scope, OrganizationService, $log, $location) {
            $scope.organizations = [];
            $scope.loading = true;
            $scope.load = function () {
                $log.debug("Trying to load the organizations for this user.");
                $scope.organizations = OrganizationService.query({}, function () {
                    $log.debug("List of organizations retrieved.");
                    $scope.loading = false;
                }, function () {
                    $log.warn("List of organizations could NOT be retrieved.");
                    $scope.loading = false;
                });
            };
            $scope.showCreateForm = function () {
                $location.path('/accounts/organizations/new');
            };
            $scope.remove = function (organization) {
                organization.$remove().then(function () {
                    $log.debug("Organization removed");
                    $scope.organizations.splice($scope.organizations.indexOf(organization), 1);
                });
            };
            $scope.load();
        }
    ]);
    HawkularAccounts.OrganizationNewController = HawkularAccounts._module.controller("HawkularAccounts.OrganizationNewController", [
        '$scope',
        'HawkularAccounts.OrganizationService',
        '$log',
        '$location',
        function ($scope, OrganizationService, $log, $location) {
            $scope.organizationNew = new OrganizationService({});
            $scope.persist = function () {
                $scope.organizationNew.$save({}, function () {
                    $log.debug("Organization added.");
                    $location.path('/accounts/organizations');
                }, function () {
                    $log.debug("Organization could NOT be added.");
                });
                $log.debug("Trying to persist the organization");
            };
        }
    ]);
    HawkularAccounts.OrganizationService = HawkularAccounts._module.service("HawkularAccounts.OrganizationService", ["$resource", function ($resource) {
        return $resource('http://localhost:8080/hawkular-accounts/organizations/:id', { id: '@id' });
    }]);
    HawkularAccounts._module.requires.push("ngResource");
})(HawkularAccounts || (HawkularAccounts = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluY2x1ZGVzLmpzIiwiL1VzZXJzL210aG8xMS9wcm9qZWN0cy9oYXdrdWxhci11aS1jb21wb25lbnRzL2FjY291bnRzL3RzL2FjY291bnRzR2xvYmFscy50cyIsIi9Vc2Vycy9tdGhvMTEvcHJvamVjdHMvaGF3a3VsYXItdWktY29tcG9uZW50cy9hY2NvdW50cy90cy9hY2NvdW50c1BsdWdpbi50cyIsIi9Vc2Vycy9tdGhvMTEvcHJvamVjdHMvaGF3a3VsYXItdWktY29tcG9uZW50cy9hY2NvdW50cy90cy9hdXRoLnRzIiwiL1VzZXJzL210aG8xMS9wcm9qZWN0cy9oYXdrdWxhci11aS1jb21wb25lbnRzL2FjY291bnRzL3RzL2F1dGhJbnRlcmNlcHRvci50cyIsIi9Vc2Vycy9tdGhvMTEvcHJvamVjdHMvaGF3a3VsYXItdWktY29tcG9uZW50cy9hY2NvdW50cy90cy9vcmdhbml6YXRpb25zLnRzIl0sIm5hbWVzIjpbIkhhd2t1bGFyQWNjb3VudHMiLCJIYXdrdWxhckFjY291bnRzLkF1dGhTZXJ2aWNlIiwiSGF3a3VsYXJBY2NvdW50cy5BdXRoU2VydmljZS5jb25zdHJ1Y3RvciIsIkhhd2t1bGFyQWNjb3VudHMuQXV0aFNlcnZpY2Uua2V5Y2xvYWsiLCJIYXdrdWxhckFjY291bnRzLkF1dGhTZXJ2aWNlLm9uUmVhZHkiLCJIYXdrdWxhckFjY291bnRzLkF1dGhTZXJ2aWNlLmxvZ291dCIsIkhhd2t1bGFyQWNjb3VudHMuQXV0aFNlcnZpY2UudXBkYXRlVG9rZW4iLCJIYXdrdWxhckFjY291bnRzLkF1dGhTZXJ2aWNlLnRva2VuIiwiSGF3a3VsYXJBY2NvdW50cy5BdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQiLCJIYXdrdWxhckFjY291bnRzLkF1dGhJbnRlcmNlcHRvclNlcnZpY2UiLCJIYXdrdWxhckFjY291bnRzLkF1dGhJbnRlcmNlcHRvclNlcnZpY2UuY29uc3RydWN0b3IiLCJIYXdrdWxhckFjY291bnRzLkF1dGhJbnRlcmNlcHRvclNlcnZp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Q0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFFSkEsd0JBQU9BLENBQUNBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBO0FBQ3hDQSxDQUFDQSxFQS9ETSxnQkFBZ0IsS0FBaEIsZ0JBQWdCLFFBK0R0QiIsImZpbGUiOiJjb21waWxlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbbnVsbCwiLy8vIENvcHlyaWdodCAyMDE0LTIwMTUgUmVkIEhhdCwgSW5jLiBhbmQvb3IgaXRzIGFmZmlsaWF0ZXNcbi8vLyBhbmQgb3RoZXIgY29udHJpYnV0b3JzIGFzIGluZGljYXRlZCBieSB0aGUgQGF1dGhvciB0YWdzLlxuLy8vXG4vLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vLy9cbi8vLyAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy8vXG4vLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9pbmNsdWRlcy50c1wiLz5cbm1vZHVsZSBIYXdrdWxhckFjY291bnRzIHtcbiAgICBleHBvcnQgdmFyIHBsdWdpbk5hbWUgPSBcImhhd2t1bGFyLWFjY291bnRzXCI7XG4gICAgZXhwb3J0IHZhciBsb2c6TG9nZ2luZy5Mb2dnZXIgPSBMb2dnZXIuZ2V0KHBsdWdpbk5hbWUpO1xuICAgIGV4cG9ydCB2YXIgdGVtcGxhdGVQYXRoID0gXCJwbHVnaW5zL2FjY291bnRzL2h0bWxcIjtcbn1cbiIsIi8vLyBDb3B5cmlnaHQgMjAxNC0yMDE1IFJlZCBIYXQsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzXG4vLy8gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQgYnkgdGhlIEBhdXRob3IgdGFncy5cbi8vL1xuLy8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy8vXG4vLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vL1xuLy8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vaW5jbHVkZXMudHNcIi8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiYWNjb3VudHNHbG9iYWxzLnRzXCIvPlxubW9kdWxlIEhhd2t1bGFyQWNjb3VudHMge1xuICAgIGV4cG9ydCB2YXIgX21vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKEhhd2t1bGFyQWNjb3VudHMucGx1Z2luTmFtZSwgW10pO1xuICAgIHZhciBhY2NvdW50c1RhYjphbnkgPSB1bmRlZmluZWQ7XG5cbiAgICBfbW9kdWxlLmNvbmZpZyhbJyRsb2NhdGlvblByb3ZpZGVyJywgJyRyb3V0ZVByb3ZpZGVyJywgJ0hhd3Rpb05hdkJ1aWxkZXJQcm92aWRlcicsICgkbG9jYXRpb25Qcm92aWRlciwgJHJvdXRlUHJvdmlkZXI6bmcucm91dGUuSVJvdXRlUHJvdmlkZXIsIGJ1aWxkZXI6SGF3dGlvTWFpbk5hdi5CdWlsZGVyRmFjdG9yeSkgPT4ge1xuICAgICAgICBhY2NvdW50c1RhYiA9IGJ1aWxkZXIuY3JlYXRlKClcbiAgICAgICAgICAgIC5pZChIYXdrdWxhckFjY291bnRzLnBsdWdpbk5hbWUpXG4gICAgICAgICAgICAudGl0bGUoKCkgPT4gXCJBY2NvdW50c1wiKVxuICAgICAgICAgICAgLmhyZWYoKCkgPT4gXCIvYWNjb3VudHNcIilcbiAgICAgICAgICAgIC5zdWJQYXRoKFwiTXkgYWNjb3VudFwiLCBcImFjY291bnRzXCIsIGJ1aWxkZXIuam9pbihIYXdrdWxhckFjY291bnRzLnRlbXBsYXRlUGF0aCwgJ2FjY291bnRzLmh0bWwnKSlcbiAgICAgICAgICAgIC5zdWJQYXRoKFwiT3JnYW5pemF0aW9uc1wiLCBcIm9yZ2FuaXphdGlvbnNcIiwgYnVpbGRlci5qb2luKEhhd2t1bGFyQWNjb3VudHMudGVtcGxhdGVQYXRoLCAnb3JnYW5pemF0aW9ucy5odG1sJykpXG4gICAgICAgICAgICAuYnVpbGQoKTtcbiAgICAgICAgYnVpbGRlci5jb25maWd1cmVSb3V0aW5nKCRyb3V0ZVByb3ZpZGVyLCBhY2NvdW50c1RhYik7XG5cbiAgICAgICAgJHJvdXRlUHJvdmlkZXIud2hlbignL2FjY291bnRzL29yZ2FuaXphdGlvbnMvbmV3Jywge3RlbXBsYXRlVXJsOiBidWlsZGVyLmpvaW4oSGF3a3VsYXJBY2NvdW50cy50ZW1wbGF0ZVBhdGgsICdvcmdhbml6YXRpb25fbmV3Lmh0bWwnKX0pO1xuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAgfV0pO1xuXG4gICAgX21vZHVsZS5ydW4oWydIYXd0aW9OYXYnLCAoSGF3dGlvTmF2Okhhd3Rpb01haW5OYXYuUmVnaXN0cnkpID0+IHtcbiAgICAgICAgLy9IYXd0aW9OYXYuYWRkKGFjY291bnRzVGFiKTtcbiAgICB9XSk7XG5cbiAgICBoYXd0aW9QbHVnaW5Mb2FkZXIuYWRkTW9kdWxlKEhhd2t1bGFyQWNjb3VudHMucGx1Z2luTmFtZSk7XG59XG4iLCIvLy8gQ29weXJpZ2h0IDIwMTQtMjAxNSBSZWQgSGF0LCBJbmMuIGFuZC9vciBpdHMgYWZmaWxpYXRlc1xuLy8vIGFuZCBvdGhlciBjb250cmlidXRvcnMgYXMgaW5kaWNhdGVkIGJ5IHRoZSBAYXV0aG9yIHRhZ3MuXG4vLy9cbi8vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vL1xuLy8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vLy9cbi8vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImFjY291bnRzUGx1Z2luLnRzXCIvPlxuLyoqXG4gKiBBdHRlbnRpb246IHRoaXMgY2xhc3Mgd2lsbCBwcm9iYWJseSBiZSByZXBsYWNlZCBieSB0aGUgcHJvcGVyIGhhd3QuaW8gS2V5Y2xvYWsgaW50ZWdyYXRpb24uXG4gKiBXaGlsZSBpdCdzIG5vdCBkb25lLCB3ZSBhcmUgZG9pbmcgdGhlIGludGVncmF0aW9uIGJ5IG91cnNlbHZlcy5cbiAqL1xubW9kdWxlIEhhd2t1bGFyQWNjb3VudHMge1xuXG4gICAgZXhwb3J0IGNsYXNzIEF1dGhTZXJ2aWNlIHtcbiAgICAgICAgcHVibGljIHN0YXRpYyAkaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyR3aW5kb3cnXTtcbiAgICAgICAgY29uc3RydWN0b3IocHJpdmF0ZSAkcm9vdFNjb3BlOm5nLklSb290U2NvcGVTZXJ2aWNlLCBwcml2YXRlICR3aW5kb3c6bmcuSVdpbmRvd1NlcnZpY2UpIHtcbiAgICAgICAgICB0aGlzLm9uUmVhZHkoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4kcm9vdFNjb3BlWyd1c2VybmFtZSddID0gdGhpcy5rZXljbG9haygpLmlkVG9rZW5QYXJzZWQubmFtZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByaXZhdGUga2V5Y2xvYWsoKTphbnkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHdpbmRvd1sna2V5Y2xvYWsnXTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9uUmVhZHkoY2FsbGJhY2spOmFueSB7XG4gICAgICAgICAgICBpZiAodGhpcy4kd2luZG93WydrZXljbG9ha1JlYWR5J10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5rZXljbG9haygpLm9uUmVhZHkgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy4kd2luZG93WydrZXljbG9ha1JlYWR5J10gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBsb2dvdXQoKTp2b2lkIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmtleWNsb2FrKCkubG9nb3V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVUb2tlbihwZXJpb2RpY2l0eTpudW1iZXIpOmFueSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5rZXljbG9haygpLnVwZGF0ZVRva2VuKHBlcmlvZGljaXR5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRva2VuKCk6c3RyaW5nIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmtleWNsb2FrKCkudG9rZW47XG4gICAgICAgIH1cblxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQoKTpib29sZWFuIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmtleWNsb2FrKCkgJiYgdGhpcy5rZXljbG9haygpLmF1dGhlbnRpY2F0ZWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfbW9kdWxlLnNlcnZpY2UoJ0F1dGgnLCBBdXRoU2VydmljZSk7XG59XG4iLCIvLy8gQ29weXJpZ2h0IDIwMTQtMjAxNSBSZWQgSGF0LCBJbmMuIGFuZC9vciBpdHMgYWZmaWxpYXRlc1xuLy8vIGFuZCBvdGhlciBjb250cmlidXRvcnMgYXMgaW5kaWNhdGVkIGJ5IHRoZSBAYXV0aG9yIHRhZ3MuXG4vLy9cbi8vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vL1xuLy8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vLy9cbi8vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImFjY291bnRzUGx1Z2luLnRzXCIvPlxuLyoqXG4gKiBBdHRlbnRpb246IHRoaXMgY2xhc3Mgd2lsbCBwcm9iYWJseSBiZSByZXBsYWNlZCBieSB0aGUgcHJvcGVyIGhhd3QuaW8gS2V5Y2xvYWsgaW50ZWdyYXRpb24uXG4gKiBXaGlsZSBpdCdzIG5vdCBkb25lLCB3ZSBhcmUgZG9pbmcgdGhlIGludGVncmF0aW9uIGJ5IG91cnNlbHZlcy5cbiAqL1xubW9kdWxlIEhhd2t1bGFyQWNjb3VudHMge1xuXG4gICAgZXhwb3J0IGNsYXNzIEF1dGhJbnRlcmNlcHRvclNlcnZpY2Uge1xuICAgICAgICBwdWJsaWMgc3RhdGljICRpbmplY3QgPSBbJyRxJywgJ0F1dGgnXTtcblxuICAgICAgICBwdWJsaWMgc3RhdGljIEZhY3RvcnkoJHE6bmcuSVFTZXJ2aWNlLCBBdXRoOkhhd2t1bGFyQWNjb3VudHMuQXV0aFNlcnZpY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXV0aEludGVyY2VwdG9yU2VydmljZSgkcSwgQXV0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlICRxOm5nLklRU2VydmljZSwgcHJpdmF0ZSBBdXRoOkhhd2t1bGFyQWNjb3VudHMuQXV0aFNlcnZpY2UpIHtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlcXVlc3QgPSAocmVxdWVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnSW50ZXJjZXB0aW5nIHJlcXVlc3QnKTtcbiAgICAgICAgICAgIHZhciBCQVNFX1VSTCA9IFwiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2hhd2t1bGFyLVwiO1xuICAgICAgICAgICAgdmFyIGFkZEJlYXJlciwgZGVmZXJyZWQ7XG4gICAgICAgICAgICBpZiAocmVxdWVzdC51cmwuaW5kZXhPZihCQVNFX1VSTCkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZygnVGhlIHJlcXVlc3RlZCBVUkwgaXMgbm90IHBhcnQgb2YgdGhlIGJhc2UgVVJMLiBCYXNlIFVSTDogJyArIEJBU0VfVVJMICsgJywgcmVxdWVzdGVkIFVSTDogJyArIHJlcXVlc3QudXJsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFkZEJlYXJlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5BdXRoLnVwZGF0ZVRva2VuKDUpLnN1Y2Nlc3MoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRva2VuID0gdGhpcy5BdXRoLnRva2VuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdBZGRpbmcgYmVhcmVyIHRva2VuIHRvIHRoZSByZXF1ZXN0OiAnICsgdG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmVhcmVyICcgKyB0b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLm5vdGlmeSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnJlc29sdmUocmVxdWVzdCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmVycm9yKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ291bGRuJ3QgdXBkYXRlIHRva2VuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBkZWZlcnJlZCA9IHRoaXMuJHEuZGVmZXIoKTtcbiAgICAgICAgICAgIHRoaXMuQXV0aC5vblJlYWR5KGFkZEJlYXJlcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kcS53aGVuKGRlZmVycmVkLnByb21pc2UpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc3BvbnNlRXJyb3IgPSAocmVqZWN0aW9uKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdJbnRlcmNlcHRpbmcgZXJyb3IgcmVzcG9uc2UnKTtcbiAgICAgICAgICAgIGlmIChyZWplY3Rpb24uc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBub3RpZnkgdGhlIHVzZXIgdGhhdCB0aGUgc2Vzc2lvbiBpcyBleHBpcmVkXG4gICAgICAgICAgICAgICAgdGhpcy5BdXRoLmxvZ291dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHEucmVqZWN0KHJlamVjdGlvbik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgX21vZHVsZS5jb25maWcoZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xuICAgICAgICBjb25zb2xlLmRlYnVnKCdBZGRpbmcgQXV0aEludGVyY2VwdG9yJyk7XG4gICAgICAgIHJldHVybiAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKEhhd2t1bGFyQWNjb3VudHMuQXV0aEludGVyY2VwdG9yU2VydmljZS5GYWN0b3J5KTtcbiAgICB9KTtcbn1cbiIsIi8vLyBDb3B5cmlnaHQgMjAxNC0yMDE1IFJlZCBIYXQsIEluYy4gYW5kL29yIGl0cyBhZmZpbGlhdGVzXG4vLy8gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyBhcyBpbmRpY2F0ZWQgYnkgdGhlIEBhdXRob3IgdGFncy5cbi8vL1xuLy8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy8vXG4vLy8gICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vL1xuLy8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiYWNjb3VudHNQbHVnaW4udHNcIi8+XG5tb2R1bGUgSGF3a3VsYXJBY2NvdW50cyB7XG5cbiAgICBleHBvcnQgdmFyIE9yZ2FuaXphdGlvbnNDb250cm9sbGVyID0gX21vZHVsZS5jb250cm9sbGVyKFwiSGF3a3VsYXJBY2NvdW50cy5Pcmdhbml6YXRpb25zQ29udHJvbGxlclwiLCBbXG4gICAgICAgICckc2NvcGUnLCAnSGF3a3VsYXJBY2NvdW50cy5Pcmdhbml6YXRpb25TZXJ2aWNlJywgJyRsb2cnLCAnJGxvY2F0aW9uJyxcbiAgICAgICAgKCRzY29wZSwgT3JnYW5pemF0aW9uU2VydmljZSwgJGxvZywgJGxvY2F0aW9uKSA9PiB7XG5cbiAgICAgICAgICAgICRzY29wZS5vcmdhbml6YXRpb25zID0gW107XG4gICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAkc2NvcGUubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAkbG9nLmRlYnVnKFwiVHJ5aW5nIHRvIGxvYWQgdGhlIG9yZ2FuaXphdGlvbnMgZm9yIHRoaXMgdXNlci5cIik7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZ2FuaXphdGlvbnMgPSBPcmdhbml6YXRpb25TZXJ2aWNlLnF1ZXJ5KHt9LFxuICAgICAgICAgICAgICAgICAgICAoKT0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2cuZGVidWcoXCJMaXN0IG9mIG9yZ2FuaXphdGlvbnMgcmV0cmlldmVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2cud2FybihcIkxpc3Qgb2Ygb3JnYW5pemF0aW9ucyBjb3VsZCBOT1QgYmUgcmV0cmlldmVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRzY29wZS5zaG93Q3JlYXRlRm9ybSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2FjY291bnRzL29yZ2FuaXphdGlvbnMvbmV3Jyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJHNjb3BlLnJlbW92ZSA9IChvcmdhbml6YXRpb24pID0+IHtcbiAgICAgICAgICAgICAgICBvcmdhbml6YXRpb24uJHJlbW92ZSgpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZWQhXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9nLmRlYnVnKFwiT3JnYW5pemF0aW9uIHJlbW92ZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JnYW5pemF0aW9ucy5zcGxpY2UoJHNjb3BlLm9yZ2FuaXphdGlvbnMuaW5kZXhPZihvcmdhbml6YXRpb24pLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUubG9hZCgpO1xuICAgICAgICB9XSk7XG5cbiAgICBleHBvcnQgdmFyIE9yZ2FuaXphdGlvbk5ld0NvbnRyb2xsZXIgPSBfbW9kdWxlLmNvbnRyb2xsZXIoXCJIYXdrdWxhckFjY291bnRzLk9yZ2FuaXphdGlvbk5ld0NvbnRyb2xsZXJcIiwgW1xuICAgICAgICAnJHNjb3BlJywgJ0hhd2t1bGFyQWNjb3VudHMuT3JnYW5pemF0aW9uU2VydmljZScsICckbG9nJywgJyRsb2NhdGlvbicsXG4gICAgICAgICgkc2NvcGUsIE9yZ2FuaXphdGlvblNlcnZpY2UsICRsb2csICRsb2NhdGlvbikgPT4ge1xuXG4gICAgICAgICAgICAkc2NvcGUub3JnYW5pemF0aW9uTmV3ID0gbmV3IE9yZ2FuaXphdGlvblNlcnZpY2Uoe30pO1xuICAgICAgICAgICAgJHNjb3BlLnBlcnNpc3QgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yZ2FuaXphdGlvbk5ldy4kc2F2ZSh7fSxcbiAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3VjY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvZy5kZWJ1ZyhcIk9yZ2FuaXphdGlvbiBhZGRlZC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2FjY291bnRzL29yZ2FuaXphdGlvbnMnKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2cuZGVidWcoXCJPcmdhbml6YXRpb24gY291bGQgTk9UIGJlIGFkZGVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgJGxvZy5kZWJ1ZyhcIlRyeWluZyB0byBwZXJzaXN0IHRoZSBvcmdhbml6YXRpb25cIik7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSk7XG5cbiAgICBleHBvcnQgdmFyIE9yZ2FuaXphdGlvblNlcnZpY2UgPSBfbW9kdWxlLnNlcnZpY2UoXCJIYXdrdWxhckFjY291bnRzLk9yZ2FuaXphdGlvblNlcnZpY2VcIiwgW1wiJHJlc291cmNlXCIsICgkcmVzb3VyY2UpID0+IHtcbiAgICAgICAgcmV0dXJuICRyZXNvdXJjZSgnaHR0cDovL2xvY2FsaG9zdDo4MDgwL2hhd2t1bGFyLWFjY291bnRzL29yZ2FuaXphdGlvbnMvOmlkJywge2lkOidAaWQnfSk7XG4gICAgfV0pO1xuXG4gICAgX21vZHVsZS5yZXF1aXJlcy5wdXNoKFwibmdSZXNvdXJjZVwiKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
angular.module("hawkular-ui-components-accounts-templates", []).run(["$templateCache", function($templateCache) {$templateCache.put("plugins/accounts/html/accounts.html","<div class=\"row\">\n    <div class=\"col-md-12\">\n        <h1>Accounts</h1>\n        Your account can be managed directly at <a href=\"http://localhost:8080/auth/realms/hawkular/account\">Keycloak</a>.\n    </div>\n</div>\n");
$templateCache.put("plugins/accounts/html/organization_new.html","<div class=\"row\">\n    <div class=\"col-md-12\" data-ng-controller=\"HawkularAccounts.OrganizationNewController\">\n        <ol class=\"breadcrumb\">\n            <li><a data-ng-href=\"/\">Hawkular</a></li>\n            <li><a data-ng-href=\"/\">Accounts</a></li>\n            <li><a data-ng-href=\"/accounts/organizations\">Organizations</a></li>\n        </ol>\n        <h1>\n            Add Organization\n        </h1>\n\n        <form role=\"form\" class=\"form-horizontal\">\n            <div class=\"form-group\">\n                <label for=\"name\" class=\"col-md-2 control-label\">Name <span class=\"required\">*</span> </label>\n                <div class=\"col-md-6\">\n                    <input type=\"text\" class=\"form-control\" id=\"name\" placeholder=\"Name\"\n                           data-ng-model=\"organizationNew.name\">\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label for=\"description\" class=\"col-md-2 control-label\">Description</label>\n                <div class=\"col-md-6\">\n                    <input type=\"text\" class=\"form-control\" id=\"description\" placeholder=\"Description\"\n                           data-ng-model=\"organizationNew.description\">\n                </div>\n            </div>\n            <div class=\"col-md-8\">\n                <div class=\"pull-right\">\n                    <a data-ng-href=\"/accounts/organizations\" class=\"btn btn-default btn-lg\">Cancel</a>\n                    <button data-ng-click=\"persist()\" type=\"submit\" class=\"btn btn-primary btn-lg\">Save</button>\n                </div>\n            </div>\n\n        </form>\n    </div><!-- /col -->\n</div><!-- /row -->\n");
$templateCache.put("plugins/accounts/html/organizations.html","<div class=\"row\">\n    <div class=\"col-md-12\" data-ng-controller=\"HawkularAccounts.OrganizationsController\">\n        <ol class=\"breadcrumb\">\n            <li><a data-ng-href=\"/\">Hawkular</a></li>\n            <li><a data-ng-href=\"/\">Accounts</a></li>\n            <li><a data-ng-href=\"/accounts/organizations\">Organizations</a></li>\n        </ol>\n        <div class=\"pull-right\">\n            <button class=\"btn btn-primary\" type=\"button\" role=\"button\" data-ng-click=\"showCreateForm()\">Create</button>\n        </div>\n\n        <h1>Organizations</h1>\n        <div class=\"progress-description\" data-ng-show=\"loading\">\n            <div class=\"spinner spinner-xs spinner-inline\"></div> <strong>Loading:</strong> Organizations\n        </div>\n        <div class=\"row\" data-ng-show=\"!organizations.length && !loading\">\n            <div class=\"col-sm-6\">\n                No organizations yet. How about creating one?\n            </div>\n        </div>\n\n        <div data-ng-show=\"organizations.length && !loading\">\n            <table class=\"table table-striped table-bordered\">\n                <thead>\n                    <tr>\n                        <th>Name</th>\n                        <th>Description</th>\n                        <th>&nbsp;</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr data-ng-repeat=\"organization in organizations\">\n                        <td>{{organization.name}}</td>\n                        <td>{{organization.description}}</td>\n                        <td>\n                            <button type=\"button\" class=\"btn btn-default\" aria-label=\"Remove\" data-ng-click=\"remove(organization)\">\n                                <span class=\"pficon pficon-delete\" aria-hidden=\"true\"></span>\n                            </button>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n    </div><!-- /col -->\n\n</div>\n</div>\n");}]); hawtioPluginLoader.addModule("hawkular-ui-components-accounts-templates");